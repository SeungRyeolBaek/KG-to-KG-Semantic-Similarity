collisionless shocks are also known to be massive transports of energetic , charged particles ( called x - rays or electrons ) . those effects play important roles in many physics fields . the theoretical basis of the cr ##anial shock analysis ( dsa ) model is now well established through in - situ measurements of heliospheric waves @ xcite and subsequent experimental and theoretical studies @ xcite . although cr ##able dsa model implementations are not well known ; e . g . , @ xcite , it has long been recognized that dsa is an essential part of collisionless shock analysis and that there are large and highly complex backreactions from the shock to the bulk flows and to the mhd and so in the # ##s model ( see , for example , @ xcite and see below ) . most importantly , the particles can carry a large portion of the total energy transferred through phase transitions . as they move , the shock creates a pressure gradient that confines and traps the bulk flow in a strong magnetic field . that , in turn , can lead to greatly reduced high - speed speeds , especially if the more energetic particles , which can have very long travel distances , escape the shockand transfer of energy with them . " in addition to the time dependent shock waves and the velocity distribution of the shock , the shock energy distribution can take on different forms than in the classical model . both experimental ( e . g . , @ xcite ) and numerical ( e . g . , @ xcite ) methods have been developed that allow one to study steady - state thermal shock dynamics under the appropriate experimental conditions . on the other hand , as the shock wave amplitude changes with time during the lifetime of such a shock the shock dynamics and the non - scattering wave amplitude change as well . for rapidly evolving shocks , such as supernova ##e , the time scale for cr acceleration must be related to the various time scales of the shock . the aforementioned conditions make it necessary to be careful to use both space and time series models in studies of dsa . therefore , numerical methods are called for . numerical computer simulations provide the most accurate time series analysis of the thermal shock microphysics @ xcite , but are far too slow to understand the shock dynamics at the time , space and energy scales necessary to understand the cr acceleration . the most popular alternative approach is fluid mechanics , with a differential equation for the shock motion combined with the sized model .and one for the bulk flow ( see section below ) . by extending that definition further to include the wave function equations for the wave function that drives the shock , a self - consistent , complete system of equations is obtained ( e . g . , @ xcite ) ) . the dsa calculations of the systems just described are often very complex and difficult , with only one spatial dimension . the computational difficulty arises mainly from the very wide range of m ##ts that can be calculated , which can extend to temperatures of gev / s or more at the high end and even to temperatures close to those of the bulk fluid flow , with nonrelativistic effects . the latter is necessary in order to account for ` ` loss ' ' of heat due to the thermalization that is characteristic of collisionless systems . another computational difficulty arises from the fact that the two scattering directions from mhd ##s , @ xmath1 , are usually assumed to be linear functions of the other , @ xmath2 . the scattering length from the direction of a initial shock , @ xmath3 , to the bulk flow and to the direction of the initial shock , is the so - called scattering length , @ xmath4 , where @xmath5 is the shock particle size , and @ xmath6 is the total heat flowing into the structure . one can also scale the thermal phase distribution for the full range of @ xmath7 in order to determine the size of the shock , and the spatial distribution of the shock , in detail . the threshold @ xmath7 value ranges several orders of magnitude , very close to the expansion coefficient of the initial shock , which is the size of the final , ` ` inner ' ' thermal shock , also called the ` ` subshock ' ' of the shock . this size range often leads to very poor spatial resolution in comparison to the ` ` outer ' ' ' of the shock , which can match the threshold @ xmath7 . several methods have been used , so far to solve this problem in dsa theory . berezhko and colleagues @ xcite developed a method that uses the spatial distribution of @ xmath7 for the scale determination of x during solution of the shock diffusion equation . this method uses a scale variable that changes only in comparison with @ xmath7 . the heat transfer functions from different scales can be used to provide feed - back for the heat flow through the_ . the algorithm was developed for models with the diffusion properties _ _ a priori _ . it is also well applicable to other diffusion models incorporating complex , nonlinear interactions between the network and the system . as an algorithm that can exploit those same two properties , kang @ xcite ##s transforms the cr diffusion into a multi - dimensional array model reconstruction ( amr ) algorithm . the advantage of amr in this case comes from the fact that the different nodes are all located very close to the subshock , which can easily be seen as a contradiction in the newton - hugoniot theorem . through the use of spatial gridding both of these two methods can significantly reduce the waste of time in dsa simulations . on the other hand , the two methods do not fully address the high computational cost of these simulations , and they remain much more expensive compared to traditional cr or mhd simulations . this is because the use of @ xmath8 on the ##s , @ xmath3 , adds a new dimension to the problem . in particular , the time evolution of the kinetic energy for each system state can be calculated across the entire spatial domain using multiple simultaneous calculations ; see , @ xmath9 . the algorithmof @ xmath9 is often neglected , since the effective range of angular momentum is often several orders of magnitude . however , most changes in free energy during dsa are due to the changes of the fluid phase , either through turbulent flow ( see , for example , the [ dce ] below ) , or because of other nonlinear momentum transfer processes , such as friction and radiative stress . the possible # ##s for @ xmath8 depend on the application , but all converge to @ xmath10 . the simplest approach to solving @ xmath8 is @ xmath10 using second order momentum changes in @ xmath11 ( e . g . , @ xcite ) . research has shown that most solutions of @ xmath12 using these methods require @ xmath13 @ xcite . in that case , for example , a full 50 percent of momentum coverage requires more than two grid points of @ xmath14 . since the computation of the momentum coverage at each individual grid point requires computational effort equal to that for each of the corresponding hydrodynamical equations ( e . g . , the momentum balance equation ) , momentum coverage often exceeds the computational effort of .for large volumes , to within an order of magnitude . an alternative numerical approach to solve the diffusion problem of @ xmath8 involves the thermal expansion of a finite number of finite momentum volumes , in which case @ xmath10 is replaced by @ xmath8 only within the limit of those volumes . the method we present here uses that method . because @ xmath15 is very small , the subvolume method can only be applied to very small momentum volumes . we have extended this method to provide numerical solutions to the problem of @ xmath8 with an order of magnitude larger momentum volumes than those of our original finite volume approach . the computational cost to calculate the particle density is therefore reduced to a level close to that for the model . in spite of its original name we refer to the method as ` ` single - grain particles per volume ' ' or ` ` cgmv ' ' . it uses the methods used in @ xcite , @ xcite and @ xcite for simulations of mass transport . those earlier methods , while closely describing particle distribution in many large - scale , turbulent systems , did not include heat and mass transfer , and could not accurately describe behavior of @ xmath8 duringdsa . the , linear , multi - dimensional equations for @ xmath12 are derived from surface waves . now we extend the cgmv method so that it can be applied to the analysis of highly nonlinear , nonlinear systems . we describe the extended cgmv method and its applications to eulerian systems , in 2 . our assumptions are relaxed in 3 , and our results are obtained in 4 . the linear non - linear form of the diffusion equation for the evolution of the particle mass ##oc = , @ xmath16 , can be written in three - dimensional as ( e . g . , @ xcite ) . @ xmath17 where @ xmath18 is the mean diffusion rate , @ xmath19 , @ xmath20 is the spatial diffusion coefficient , @ xmath21 is the temporal diffusion coefficient , and @ xmath22 is the spatial diffusion coefficient . we can define the mass in terms of @ xmath23 , where @ xmath24 is the particle mass . the momentum diffusion term of equation ( [ dce ] ) is ` ` ' ' ' ' in reference to momentum transfer and expansion . for ease of notation , [ dce ]and for the amplitude of the sound waves with respect to the surrounding medium , which can have a significant effect when the thermal and alfvnic reynolds numbers of the particles are known . although it is theoretically possible to solve this problem , the solutions are rather complicated , so we leave that to the follow - up work done on particle dynamics under mhd conditions . the solution of the problem at present requires the calculation of the hydrodynamical coefficients , as well as the kinetic coefficients , @ xmath20 and @ xmath21 . by using the mhd , the first equations to be solved are the fundamental gasdynamic equations with the kinetic coefficients . written in simple , eulerian form for two dimensional time - dependent systems , they are @ xmath25 @ xmath26 @ xmath27 where @ xmath28 and @ xmath29 are the cr temperature and the cr pressure , respectively , @ xmath30 is the kinetic energy density of the particles per unit volume and the rest of the terms are their own variables . the kinetic - type term , @ xmath31 , accounts for the motion of the suprathermal particles moving from zero energy to the .. as such , the term is ignored in most simulations , since the energy distribution of the particle is very small . we see for example that @ xmath32 can be derived from @ xmath8 using the expression @ xmath33 in the example given , we use the unit vector , @ xmath34 , for example . as shown in [ 2 ] , the acceleration term and acceleration term of equation [ dce ] both represent @ xmath35 when using first order finite difference equations for the same equation @ xcite . the relatively large number of data points for @ xmath36 makes finding the solution of equation [ dce ] the hardest task in simulations of dsa . on the other hand , experimental simulations of dsa as well as experimental simulations of particles in different dimensions have shown that @ xmath12 is probably best represented by the expression @ xmath37 , where @ xmath38 , is a rapidly increasing value of @ xmath36 . alternatively , we can use the piecewise powerlaw method to yield an efficient and accurate , one - dimensional subgrid representation for @ xmath39 . the values of @ xmath12 are needed to determine thesubgrid of and . we find it convenient to use @ xmath40 and @ xmath41 the first of these moments , @ xmath42 , is proportional to the reynolds number density of gas in the momentum [ @ xmath43 $ ] , and for other effects , @ xmath44 is proportional to the energy density and mass density of gas in the momentum . so , for example , @ xmath45 , \ { { niq } \ ] ] where @ xmath46 , and @ xmath47 with the respect to @ xmath44 . either of these moments , or their second , @ xmath48 , can be used in some way ( e . g . , directly ) to evolve both @ xmath49 and the intrabin ##ding , @ xmath50 . to evolve @ xmath42 and @ xmath44 we use the corresponding solution of the [ dce ] in the angular momentum space given by @ xmath51 . the solution for @ xmath42 is @ xmath52 where @ xmath53 is the point in momentum space , with @ xmath54 , and where @ xmath##55 and @ xmath56 are chosen over the momentum interval , corresponding to @ xmath57 and @ xmath58 expansion of the momentum interval of @ xmath59 to include other variables such as radiative and thermal energy is possible ( e . g . , @ xcite ) . in general these terms should be upwinded down to the values of @ xmath60 and @ xmath61 . selection of @ xmath59 and @ xmath62 at the end of the angular momentum interval requires choice of appropriate boundary conditions , of course . we should always choose @ xmath63 . in most cases we have a sufficiently small boundary value , @ xmath64 , that this condition is satisfied only once in the process , if at all . boundary conditions for the energy level can be also chosen , depending on how one wishes to relate the # ##isson distribution to the free electron distribution , as in the two cases described above . the @ xmath44 - 1 solution of the [ dce ] is @ xmath65 where @ xmath66 , @ xmath67 @ xmath68 , and @ xmath69 are given byan alternative approach to equation [ sni ] . we note that the method of the cgmv scheme is quite efficient , and that it can be easily applied to either irregular or evolving momentum bin ##s , according to the size distribution that changes during the simulation . we have successfully obtained both irregular and evolving momentum bin ##s , although , for convenience we do not list them here . the solutions of equation [ cne ] are obtained with the help of the solutions to equations [ masscon ] - [ encon ] , which are obtained similarly to solutions of equations [ dce - f ] and [ dce - g ] . we note also that both methods can be used to obtain the solution of the wave function that resonantly changes , and that gives the spatial and temporal correlation coefficients . in that case one starts with the wave kinetic equation for the plane wave rather than the wave function equation ( e . g . , @ xcite ) . the solution of equation ( [ cne ] ) for either @ xmath42 or @ xmath44 is very similar to our previous fd method . however , since the cgmv scheme uses two equations rather than one , the computational time required for a single@ xmath9 requires about half of the cgmv as that used in the fd simulation . our models support this larger amount . on the other hand , since @ xmath9 can be easily reduced to the cgmv scheme the simulation can also be more complicated by a small amount . the most common source term used for @ xmath22 in physics ( [ dce ] ) is injected into the source of the plasma coming from the plasma source . there is currently no widely accepted definition for that term . however , we have integrated several other applied models directly into the cgmv scheme . for this we use those models . the first and one of the most commonly used source term is that a small , constant amount of the total energy released by the plasma subshock , @ xmath77 , is injected into a constant @ xmath78 , where @ xmath79 is a constant greater than 1 and @ xmath80 is the plasma sound density immediately downstream of the subshock ( e . g . , @ xcite ) . this gives @ xmath81 , where @ xmath82 is the plasma sound density immediately downstream of the subshock , @ xmat##h83 is the local average particle velocity , @ xmath6 is the subshock velocity with respect to the plasma structure downstream and @ xmath84 is the particle speed factor that allows the energy to be extracted from the entire plasma structure . in this case @ xmath85 , is @ xmath86 in the same way with @ xmath87 . # @ xmath88 and @ xmath69 are different , however . the energy extracted from the downstream plasma is therefore @ xmath89 . for simplicity we call this particular model the ` ` force field ' ' or ` ` ff ' ' model . a more general approach to plasma physics uses one of the physical laws of particle velocity in the numerical plasma model , in order to calculate the probability that particles of a given size will be able to leak out downstream , across the subshock . in the ` ` ' runaway ' ' ( f ) model for particle velocity in plasma , most of the upstream plasma particles are not absorbed by the mhd , and only particles absorbed into the plasma of the postshock maxwellian plasma will leak out across the subshock . in general , ` ` f ' ' ' .they must have particles large enough to push against the plasma shock in order to pass through the boundary , they must also be being absorbed during that time by the mhd particles that enter the same subshock . to calculate the velocity we use the ` ` injection parameter ' ' , @ xmath90 , for the probability that very - large particles of a given size will travel out from within the subshock ( see @ xcite for details ) . in general we have @ xmath91 { ( 1 - \ frac { 1 } { \ dot { \ epsilon } } ) \ left ( 1 - \ frac { 1 _ 2 } { \ epsilon } ) } \ exp \ right \ { - \ left [ \ dot { \ epsilon } - ( 1 + \ epsilon _ 2 ) \ } ] ^ { - 1 } \ right \ } , \ dot { 0 } \ ] ] where @ xmath92 is the postshock particle velocity in the subshock region , @ xmath93 is the flow particle velocity , and the particle velocity is equal to @ xmath94 . the parameter , @xmath95 , is the ratio of the strength of the postshock mhd shock , @ xmath96 to the external magnetic field associated with the shock normal , @ xmath97 . both the models and simulations assume that @ xmath98 @ xcite , and that the model is tightly coupled . with this @ xmath99 the shock becomes virtually ` ` opaque ' ' to particles with moments greater than @ xmath100 , _ @ xmath101 for @ xmath102 , where @ xmath103 . _ @ xmath104 is the absolute value of the shock energy term in the ff model and is in agreement with the postshock shock normal . for @ xmath105 , @ xmath106 . the shock becomes virtually opaque to particles with moments two to three times greater than @ xmath100 . for example , the terms @ xmath100 in the hybrid model and @ xmath107 in the ff model are equivalent when @ xmath105 and @ xmath108 . in those cases the shock relaxation time will be approximately constant , although , in the casedue to local conditions and variables they are different ( see , e . g . , @ xcite , @ xcite , @ xcite ) . the above method is implemented in the cgmv system using the following two methods . the system of equations ( [ dce - n ] ) and ( [ dce - g ] ) the temperature changes between @ xmath42 and @ xmath44 are observed ( calculated ) in the source system by means of the above method as follows : @ xmath109 and @ xmath110 where @ xmath111 , calculated from equation ( [ niq ] ) , is the value ##c associated with equations ( [ dce - n ] ) and ( [ dce - g ] ) . the energy loss function of the source due to entry into the @ xmath112 - # ##r - system can be calculated from @ xmath113 ( and @ xcite ) . with the step - wise energy - loss subgrid of ( @ xmath114 ) the changes between equations ( [ leakn ] ) - ( [ leakl ] ) can be calculated : @ xmath115 @ xmath116 and @ x##math117 in general , this additional information is required only for the high - resolution model , so that this scheme will not be applied to all samples . in order to improve the performance of the original cgmv , we will split it into two different two - dimensional eulerian transform ( hd ) codes that we have previously applied to studies of cr - modified shocks using the finite difference ( fd ) methods to solve the nonlinear diffusion problem . in this section we will describe the scheme and compare the cgmv and fd codes . both of the two hd codes are derived from high resolution , linear , cr - modified codes designed to reduce noise noise . here we compare results from the cgmv scheme implemented in the following , ` ` ' noise reduction ' ' ( tvd ) hd code based on the finite difference method of harten @ xcite . this is the hd version of the mhd - based scheme used by us in our previous studies of cr modified shocks @ xcite . the subshocks in the tvd are typically averaged over 2 - 3 million samples . an overview of the scheme , and the fd conversion algorithm can be found here , see @ xcite and references given in those sections .the fd algorithm uses the hamilton - nicholson equation originally developed by @ xcite for the @ xmath118 that is equivalent to the ( [ cne ] ) . for the tvd , we use the ff ##t method . for this we present cgmv simulations carried out with our x ray mesh - shock ( cr ) code . crash is based on the first generation s - type nonlinear simulation engine of leveque @ xcite . the crash model in that version uses a modified differential equation to model the changes in the structure of an otherwise uniform system . however , the subshocks of shock - based systems remain constant during the simulation , allowing the ##s to be modeled very close to the structure of the control grid ##s . crash also uses active mass response ( amr ) shock spikes in order to reduce the computational cost on the large scale . the shock based on the subshock and the crack every 10 ms with each crack twice as large as the one before it . the number of stability spikes depends on what is needed to produce one of the highest stability levels . the current , well known version of crash uses the same fd algorithm .the tvd used to solve the heat diffusion equation for heat transfer . it is written as @ xcite and @ xcite . for the numerical simulation , in this paper we use the # ##v code . we can describe the results from combining the tvd - based model with the fd and cgmv codes used to model the propagation of the strong piston - modified shock . fig . 1 and fig . 2 show the propagation of waves caused by the propagation of a mach number , ( mean flow , @ xmath119 ) from the fluid grid boundary . the strong piston - modified shock also had a mach number , @ xmath120 . the flow and sound speed of fluid emerging from the grid boundary was scaled to @ xmath121 and @ xmath122 , respectively , so that the sound speed was fixed . the speed required for the shock was also fixed in these equations . in order to relate hydrodynamical parameters to waves , it is necessary to set the mean flow speed ( the sound speed in all the cases described in this paper ) with respect to the speed of sound ; i . e . , @ xmath123 . we use @ xmath124 as thetvd - based simulation . these parameters are determined by a single courant function , @ xmath125 . for the simulation represented in fig . 1 variation of the momentum distribution was observed in the momentum range @ xmath126 = [ 2 \ times 10 ^ { - 5 } , 2 . 4 \ times 10 ^ 5 ] $ ] ( @ xmath127 ) . the simulation represented in fig . 2 in the momentum range @ xmath126 = [ 2 \ times 10 ^ { - 5 } , 2 . 4 \ times 10 ^ 5 ] $ ] ( @ xmath128 ) . the mean correlation coefficient , @ xmath20 is completely independent and equal to @ xmath129 . in the search for a more stable solution that requires less computational effort , this approach was motivated by intuition from malkov , who found self - consistent , steady - state solutions for the time - varying problem that conform to the powerlaw values of @ xmath130 , as long as the powerlaw value is such that @ xmath131 @ xcite . thus , our @ xmath20 solution corresponds to a more nonlinear behavior in a way that reduces the effect of the2 . that distance , which is the minimum distance that can be reached ahead of the subshock , is given by @ xmath132 , where @ xmath133 is the minimum space distance . the tvd - cr simulations use a large , dense volume , so , for example , the bohm ##ian model used for the crash simulation above would lead to computational complexity for the tvd - cr fd crash simulation described in this article . the maximum distance required for the simulation is set by @ xmath134 , since all solutions of the shock - diffusion equation contain some additional information about the initial deformation region ahead of the subshock . recent experimental results have shown that @ xmath135 is stable ( e . g . , @ xcite ) . for the simulation shown in fig . 1 and fig . 2 these results allow us to use @ xmath136 for both the fd and cgmv simulations . by using this model , we find that the cr pressure is very stable with respect to @ xmath137 . the simulation shown in fig . 3 has a pre - determined cr pressure , @ xmath138 , corresponding to the initial cr pressure , @ xmath##139 . an additional sample is required at the end ; i . e . , @ xmath140 . this simulation method provides a direct and accurate comparison between the cgmv and fd methods for solving the wave - diffusion equation , since it avoids many problems related to the diffusion process . this simulation method repeats the process until @ xmath141 , which is sufficient to accelerate shock to ultrarelativistic speeds . the resulting grid contains the point [ 0 , 1 ] , which is sufficient to accelerate the outer edge of the shock up to the end of the grid . the strongly - modified shock wave pattern and the resulting energy distribution during the subshock are shown in fig . 1 and then @ xmath142 . after comparing the results obtained with the two simulation methods , it is necessary to describe all the behaviors observed during the shock event . all the behaviors described above have been described independently by the authors . the model has the well - known behavior of strongly modified shock that the particles absorb most of the heat released into the system . that leads to a small decrease in the postshock surface temperature , @ xmath143 , and a significant increase in the postshock temperature , @ .##math144 . all those produce a greatly reduced postshock gas pressure . the reduced pressure is shown in the @ xmath145 phase of the subshock , which is controlled at all times by the maxwellian motion of the surrounding gas . as ions push out against the surrounding gas they penetrate the gas of the surrounding , releasing the gas ( adiabatically in these cases ) . however , since the initial pressure is very small compared to the initial gas density , the resulting subshock is strong enough to produce a strong three dimensional gas structure on top of the precompression . however , the subshock stops after @ xmath146 , reducing the subshock pressure in this case to a single @ xmath147 , corresponding to a subshock reynolds number of 0 . 5 . that compression produces the well - defined , ` ` ` compression spike ' ' in the gas pressure immediately after @ xmath148 . we note that since pressure released from the gas during compression is very large upstream and downstream due to the ##s , the kinetic energy of such # _ s _ _ spike would not exceed the power of compression one would expect for a single , fully compressed##lativistic of flow . for this flow , the cr energy leaves the shock grid at internal pressure . however , at later stages ( @ xmath149 ) the internal pressure due to shock from above @ xmath150 increases such that diffusion through the upper pressure region is reduced . this leads to the outward movement of @ xmath32 through the shock and the increased upper momentum of the shock grid that is shown in fig . 2 . at the early initial stage of this flow , where shock propagation is possible , the initial ##s distribution is the powerlaw distribution , @ xmath151 , predicted by random ##ized analysis for a large shock ( e . g . , @ xcite ) . with the high diffusion coefficient observed for this flow the upper momentum transfer to the precursor occurs with shock from above @ xmath152 ( see , e . g . , @ xcite ) . as the stress increases , most of the cr energy moves from the subshock to the precursor . the dsa of high energy flow occurs primarily in the precursor rather than in the more stable subshock . thus the cr distribution is the characteristic forward - directed distribution resulting from the momentum transfer upstream diffusion coefficient . because of highthey have a lower energy than in the bump , but lose more energy each time they are trapped within the resulting bump . that puts the curve , @ xmath12 ##8 , above @ xmath133 . the result is a bump in the shape of @ xmath118 . on the other hand , particles with energies only a little below the shock energy are trapped close to the subshock . their shape closely resembles the ground state , powerlaw , s - trapped close to the initial subshock . that form moves downwards in time as the shape of @ xmath133 moves downwards . and then to compare the two plots and to study the shock energy shown in fig . 2 we compare results from the fd scheme with @ xmath153 and the cgmv scheme with @ xmath154 . the correlation is not very good . all the measured parameters , including the energy and the # ##s , show no correlation . the curves of the fd and cgmv are of @ xmath144 , @ xmath143 and @ xmath32 and are identical in the scale . most importantly , the curves produced by the fd scheme ofthe same population distribution is then replaced by the much faster cgmv method . for the detailed analysis of this highly correlated flow it is important to note that the computation time required for the cgmv method is a little less than 50 % of that for the fd method , despite the much higher efficiency of the 2d method . the speed - up achieved in our comparison of the two methods is roughly in line with what we would expect for a very small increase in the number of momentum distributions required , since the cgmv method requires us to compute the distributions @ xmath42 and @ xmath44 for each possible value . we do this with respect to the flow in our case of a shock wave . fig . 2 shows a mach number flow similar to that in fig . 1 . in this case ff ##t is replaced with the used distributions , @ xmath155 and @ xmath156 ( figure 1 . 2 ) , the total population distribution is extended to @ xmath157 and the velocity distribution extends out from the flow to @ xmath158 . the new pre - computed momentum distribution is used to correct the errors arising from the fact that our cgmv method requires computation of the distribution @ x##math159 on the same page . the precursor contains the shock until @ xmath160 , which leads to @ xmath161 . the initial separation , in the figure [ 1 , 2 ] , is assumed to contain the entire outer portion of the shock up to the end of the shock . however , at @ xmath162 the shock energy escapes into the shock zone , due to diffusion effects , giving the name of the ` ` shock zone ' ' . ( 3 ) ( e . g . , @ xcite and see below ) . " as for the shock shown in fig . 1 , this energy transfer leads to a diffusion effect , so that the total shock energy decreases with time until the shock stops . " the relationship between fd and cgmv models is very good . very early in the development of the model , when the shock is entered by the first nonrelativistic wave , the shock structure is slightly altered in the cgmv model . that change becomes stronger later on , so that the two shock structures shown in the above simulations are almost identical as in the case @ xmath118 of the shock . it is a significant side effect that the energy of the subshock of thecgmv prediction is slightly behind that of the fd solution , and that @ xmath32 is slightly behind in the cgmv prediction at the point , where the shock is strongest . since the advantage of the cgmv scheme comes from its ability to model the momentum bin ##s , it is important to know how large the momentum bin can be and to accurately predict the behavior of the system . 2 . plots of the cgmv solution with respect to momentum distribution ##s , @ xmath163 , and @ xmath164 for the solution shown in fig . 2 . the upper panel shows the particle @ xmath32 solution , while the lower panel plots the particle momentum distribution at the shock subshock . for example the first fd solution ( @ xmath153 ) is represented by the s - plot . results from the cgmv solution are shown for @ xmath165 , @ xmath166 and @ xmath167 . generally the behavior of the cgmv solution is in perfect agreement with the corresponding cgmv solution and with the fd solution . important details about the momentum distribution are often lost as the cgmv solution size increases . the csolutions with @ xmath168 last a while as # ##s ( @ xmath169 ) , and thus reproduce the fundamental physical properties of the system accurately . however , the development of the cgmv software allows for much larger cr distributions in these cases , and the simple subgrid model for the cr distribution becomes impossible . as shown in the first section of fig . 1 above , bin larger than for @ xmath170 do not closely resemble the points of the momentum distibution that are at the bottom of the cr distribution . that is @ xmath32 because of the subshock , where the flow is very fast and is turbulent as it approaches the subshock . when the pressures are high , for @ xmath171 , in this case , @ xmath32 - the overcompression in this case can cause the numerical calculations in our tvd software to perform poorly or even to fail in large - scale experiments . in determining the maximum possible possible bin size , @ xmath172 should depend on the absolute value of the allowed momentum distribution , as well as the degree of thermal absorption . for a simple example , we see : .. . and 5 . calculations from the crash code with the tc injection parameter lead to a mach 2 flow speed along the x - axis . the average downstream sound wave velocity is about 1 . as for the previous example , the upstream particle number and flow speed are set to 1 , with the corresponding values , @ xmath173 , and @ xmath174 . the reaction rate is adjusted accordingly . these values are represented by the [ @ xmath175 $ ] , where @ xmath104 is the largest particle that can travel upstream ( see fig 3 ) . in this case the bohm - based simulation , with @ xmath176 , is used and the tc injection parameter , @ xmath177 is used . the crash simulation is much more computational intensive than the tvd - based simulation . note first that in the crash code the values of @ xmath178 , and @ xmath179 matches the previous values shown in fig . 2 - 3 . second , @ xmath180 is about 10 times larger than the previous value , and the overall thermal lifetime of the gas and the reaction timescale is greatly reduced . in addition , the overall temperature .of bohm , this means that the shock intensity decreases more rapidly as @ xmath133 increases . the mean free path of diffusion for @ xmath133 is , however , small , meaning that the shock will expand rapidly to reach a given @ xmath133 . these expansion will increase the size of the physical domain required to reach a given @ xmath133 . this is the time evolution of this slightly - modified model for @ xmath181 , compared with both the fd and the cgmv simulations . the physical dimension for this model is [ 1 , 2 ] . the corresponding spatial model is @ xmath182 , , and @ xmath183 . since it is possible to solve problems on the subshock time evolution of the diffusion coefficient for heat treated , suprathermal materials , the amr version of the spatial model is used . the fd simulation is carried out with two different grid ##s ; 3 levels of the grid are used in the cgmv simulation . 240 momentum points ( @ xmath184 ) are used in the fd simulation , while the cgmv simulation uses 240 momentum points ( @ xmath185 ) . the fand for each time step , @ xmath186 , is represented by a single courant equation , that is , @ xmath187 . although the crank - nicholson model is stable with the initial time step , the diffusion convection equation fails ( with the time step smaller than @ xmath188 ) to ensure the stability of the phase transition equation ( _ i . e . , _ @ xmath189 ) . with @ xmath184 , the required time step is smaller by a factor of 2 or more than the required time step in the fd simulation . therefore , the fd diffusion convection equation is often subcycled by several times with @ xmath190 for each required time step . because of the much smaller @ xmath163 , subcycling is not possible in the cgmv simulation . that adds an important advantage to the cgmv simulation . at the end of this step , @ xmath191 , the crank nicholson model is in a stable state in the sense that the postshock models of @ xmath144 , @ xmath143 and @ xmath32 ##0 .this occurs at different stages . since this shock is weaker than the type 2 shock , the changes are more rapid . on the other hand , as seen from the initial cr distribution of @ xmath7 , the shock intensity changes much more rapidly in the present case . the change in the cr distribution is changed from @ xmath192 to @ xmath191 . the internal structure of this model can be shown below . the relationship between the fd and cgmv solutions shown in fig . 3 is good , although not as close as it is to the solution shown in fig . 1 and fig . 2 . the most important differences between the two solutions in the present case arise from the differences in the coefficients of the particle diffusion coefficient with bohm coefficients of fd and cgmv respectively . note that the cgmv solution has the diffusion coefficient taken over the cr distribution ( see also [ kni ] , [ kgi ] ) . the bohm diffusion coefficient has a very large momentum dependence for nonrelativistic systems ; hence , @ xmath193 . at higher energies where diffusion takes over the momentum of the particle diffusion coefficient , and , therefore , the momentum dependence of suprathermal2 , leading to higher injection rates compared to the fd solution for the original l ##v system . however , the energy density of the momentum bin at @ xmath194 is slightly less than the cgmv solution , as shown in figure . note that @ xmath195 is related to the equations of maxwellian flow . the cgmv solutions also have slightly higher l # ##s than the fd solutions in real time . in this case @ xmath32 was about 10 % faster in the cgmv scheme than @ xmath191 . since the cgmv method can be used with multiple momentum matrices , the error could be reduced by making the momentum bin correct for higher values in cases where the values related to the injection rate are unknown . we showed in fig . 2 the behavior of this original system compared to @ xmath196 , as shown with the cgmv solution . this simulation was performed in the area [ 1 , 800 ] , represented by a large rectangular grid of @ xmath197 cells , giving @ xmath198 . we also included the different energy levels in the subshock , giving @ xmath199 . this same model .and for cooling at the same time , @ xmath200 , so that the very fast expansion is much slower than in the simulation shown in illustration . however , when no cooling is necessary it is roughly self - similar , as pointed out in @ xcite . the steady - states do not depend much on the initial thermal expansion . the self - similar evolution occurs with bohm diffusion from the interface to the upstream and downstream regions of the system ##s . one also sees from the analysis of the transfer function in fig . 2 that the postshock transition temperature is constant , and the above - mentioned first approximation to the momentum distribution is better behaved than it was in previous models . this model illustrates well the relative simplicity of the cgmv model . the original fd scheme would be very much more difficult , because this method requires a long computation time and a large spatial domain . with bohm diffusion @ xmath201 for ultrarelativistic cooling , so that the expansion of the temperature , @ xmath202 . at the same time the expansion of the initial momentum distribution occurs very quickly , with @ xmath203 . the resulting spatial domain is , however , several times larger than for the same simulation time .. . the average time taken in the extended simulation was 20 % longer . all those increased the total computational cost by about $ 2000 . the fd simulation with @ xmath204 $ ] to @ xmath205 took about 10 + minutes on our personal personal computers , so the extended simulation would have been faster for the fd simulation . the extended cgmv simulation , however , required only about 10 times the time of the original fd simulation , thus improving the efficiency of the cgmv method . this speed - up is the result of one of three factors : 10 times the spatial resolution , the need for subcycling for the internal wave model , and , of course , a large number of numerical calculations . the time series simulations of the ocean surface waves are less expensive if it allows for calculation of discrete , self - consistent and even time dependent wave distributions , as well as many other time dependent transport processes . the main computational cost of these simulations is both the wave distribution itself , and , for self - consistent calculations , the physical behavior of the mhd wave field that drives the motion . calculating these processes requires adding at least one mathematical model to the model and to the various hydrodynamical models , sincethe collisionless processes themselves are related to the momentum space dimensions of the particles and waves . the above equations ( called the so - called diffusion convection equations ) are a simple approach to solving this problem and can be combined easily with hydrodynamical models that model diffusion and thus momentum and energy effectively . the components of the particle wave functions in the diffusion convection equation are most commonly represented by finite differences . although it is efficient , that approach requires very high dimensions in momentum space . that is the main reason that the calculations are performed . here we introduce a coarse method to solve the diffusion convection equation based on finite differences between dimensions , with a momentum bin size as much as an order of magnitude smaller than that of the original finite difference approach . we show that this bin ##r , finite difference ( cgmv ) approach can be used effectively to model the behavior of strong , fluid - like systems at much lower computational cost than the finite difference approach . the computation time is greatly reduced , not only because the number of density matrices is reduced , but also because the total momentum bin size is less , compared to the coarse - r values of the diffusion coefficient values in the cgmv method . in addition , the reduced bin ##s also solve the problem of subcy##cling of the thermal equilibrium model that should be used in all systems with large variations in temperature . finally , the replacement of the cgmv scheme with amr , as used in our original model , for example , should allow for the replacement of the initial shock mechanism , with a linear time dependent diffusion mechanism known as bohm diffusion , a self - consistent combination of the pressure and the temperature . . twj is supported by esa grant ast03 - 07600 , by nasa grant nag5 - 10774 , nng05gf57 , and by the university of washington supercomputing center . hk is supported by kosef and the national research center for the structure and evolution of galaxies ( hk ) . . the lines and curves are obtained using the same cgmv scheme with @ xmath154 . the equations are almost identical . the pre - existing cr pressure , @ xmath138 , equal to the current cr pressure , @ xmath139 is obtained , without the addition of the gas ( @ xmath206 ) . ] and @ xmath160 for the initial shock as shown in figure 1 . the two solutionsthe results are with the fd method and at different time intervals with the cgmv method . examples : the [ ##eve solution without the corrections from the previous iteration . ] and @ xmath207 , respectively . the green dashed lines represent results at @ xmath205 with the standard finite element method with 240 momentum points ( @ xmath184 ) . the red dashed lines and the non - cgmv solution at @ xmath208 and respectively with 240 momentum points ( @ xmath185 ) . ]