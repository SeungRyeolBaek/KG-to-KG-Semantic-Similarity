an _ @ xmath0 - graph _ is a graph which at each vertex admits a bijection from the adjacent half - edges to the vertices of the cycle graph . half - edges which are mapped to adjacent vertices are ( r ) _ edges _ . half - edges are said to be _ edges _ if they are mapped to vertices of equal order in the cycle graph . for an edge of an @ xmath0 - graph @ xmath2 into the graph @ xmath3 we can insert an edge of @ xmath2 into @ xmath3 such that the binary relation of being opposite agrees with the relation of being opposite induced by the edge . an _ edge _ of an @ xmath0 - graph is a pair of adjacent half - edges to a vertex . an _ @ color _ of a @ xmath0 - graph @ xmath2 into @ xmath3 is an edge such that the vertices of @ xmath4 have a half - coloring in which two vertices with a matching coloring have opposite colors . these embeddings are precisely those embeddings whose _ @ xmath1 - graphthis is 3 . in @ xcite the second named author ( v . m . m . ) introduced a solution to the problem of whether four - vertex framed graphs are embedded . in @ xcite , we introduced the problem of determining the class of surfaces into which four - vertex ##ed graphs may be embedded , in particular , the special class of surfaces into which four - vertex framed graphs may be self - embedded . in @ xcite , the third named author ( v . m . ) introduced @ xmath0 - graphs as a class of four - vertex framed graphs , and introduced the planarity condition for @ xmath0 - graphs with each vertex of degree 4 or 6 . in @ xcite , the authors introduced the class of orientable surfaces into which @ xmath0 - graphs with each vertex of degree 4 or 6 may be self - embedded , using some of the results of @ xcite . in this book , we started the process of applying results on embeddability conditions of @ four - vertex graphs to @ xmath0 - graphs with each vertex of degree 4 or 6 , and on self - embeddability into nonorientable surfaces. in figure [ 2 ] we show that this is equivalent to a problem on matrices . our results are identical to those used in our earlier paper @ xcite , which are themselves based directly on those used in the first principal component ( p . i . p . ) of @ xcite for the zero - dimensional case . the goal of this paper is to find a method for determining whether a cycle @ xmath0 - graph @ xmath2 is a cycle embedded into a nonorientable subset of graph @ xmath5 . we show that this is equivalent to a problem on matrices . to do this , we construct a graph @ xmath6 graph @ xmath2 with several properties , including a self - dual ##ity . . we construct a relation between the embeddings of @ xmath2 and ` ` ' copies ' ' of the chord diagrams @ xmath7 , where the intersection of each rotation cycle is a pair of chord diagrams . we also show that the number of rotation ( first ) circles in the graph is equal to the number of circles resulting from intersection of the copies ( second ) of these chord diagrams . the tie - breaker problem isthen to calculate the number of cells formed from intersections of the circle , in terms of the size of their intersection graph , @ xmath1 . from this we calculate the total number of cells in the circle , from which the genus @ xmath5 of the circle can be easily calculated . the authors of this article would like to thank vladimir anatolievich vassiliev and sergei vladimirovich chmutov for their work . a _ @ xmath0 - atom _ is a small half - circle @ xmath3 into which the _ skeleton @ xmath2 ( the _ genus _ of the @ xmath0 - atom ) is embedded in such a way that it divides @ xmath3 into black and white , so that cells sharing an edge have different colors . this then forms an @ xmath0 - structure on the surface . the @ xmath0 - structure at each vertex is a set of @ xmath8 cells among which we know that two angles are equal if they share a half - circle . the two angles always have the same color . thus the circle around each vertex can be divided into two circles @ xmath9 and @ xmath10 .and that is that for each @ xmath0 - atom corresponding to the @ xmath0 - graph @ xmath2 , either all angles in @ xmath9 are black and all angles in @ xmath10 are white , or all angles in @ xmath9 are white and all angles in @ xmath10 are black . now for a given @ xmath0 - graph @ xmath2 , the @ xmath0 - atoms corresponding to @ xmath2 are all determined by the choice of one of the two possible colors for each vertex . so the above algorithm can be generalized as follows : given an @ xmath0 - graph @ xmath2 in which all vertices have genus 5 or higher , choose a coloring for the graph at each vertex such that the genus of the entire graph is 1 . if such a graph has @ xmath11 vertices , so have @ xmath12 and @ xmath0 - graphs . the _ _ mapping _ @ xmath6 of an @ xmath0 - graph @ xmath2 is a surjective mapping @ xmath13 which maps one - to - one , at the edges ,and note that a polynomial of degree @ xmath8 has @ xmath14 preimages . given an alternating circuit @ xmath6 of a @ xmath0 - graph @ xmath2 , a 6 - vertex @ xmath15 is _ splitting _ with respect to @ xmath6 if for every @ xmath16 , @ xmath17 and @ xmath18 are on adjacent half - edges around @ xmath19 . given an alternating circuit @ xmath6 of a @ xmath0 - graph @ xmath2 , a 6 - vertex @ xmath15 is _ splitting _ with respect to @ xmath6 if for every @ xmath16 , @ xmath17 and @ xmath18 are on adjacent half - edges around @ xmath19 . given an alternating circuit @ xmath6 of a @ xmath0 - graph @ xmath2 , a 6 - vertex @ xmath15 is _ splitting _ with respect to @ xmath6 if for every @ xmath16 , @ xmath17 and @ xmath18 are on adjacent half - edges around @ xmat##h19 , and for the last three , @ xmath20 , @ xmath21 and @ xmath22 are on adjacent half - edges , and @ xmath23 and @ xmath24 are on adjacent half - edges . a _ rotating - splitting circuit _ is a circuit with edges to which each edge is rotating or splitting . a rotating - splitting circuit has an angle in the half - plane of a given half - plane . if the angle of the edges of @ xmath17 and @ xmath18 agrees with this angle , then the circuit is _ rotating _ split _ ; otherwise it is _ split _ . see also [ r0 t ] , [ r1 t ] , [ r2 t ] , [ r3 t ] . [ rscycle - graph ] if @ xmath2 is a complete @ xmath0 - graph in which all vertices have order 5 or higher , then @ xmath2 is a rotating - splitting circuit . apply to each edge a rotation - splitting circuit . this is a partition of the vertices of @ xmath2 into half - cycles . if there is only one such cycle , we are satisfied . if there are twothan one has , since the graph is connected , there must be a vertex @ xmath19 shared by both vertices . if @ xmath19 has degree 5 , it must be connected , and we can connect the two vertices shown at @ xmath19 by adding to @ xmath19 the lowest possible rotation structure . if @ xmath19 has degree 5 , we form the cycle network , starting at @ xmath19 , starting at one of the two vertices , and repeating the crossing - over process until we come back to @ xmath19 . there are two additional cycles , corresponding to a change in vertices . if one of these cycles connects a pair of two vertices at @ xmath19 , we can add to @ xmath19 the rotation structure shown on the left side of figure [ r0t - 2 ] , such that the two vertices are joined together , and @ xmath19 is the rotation structure with a rotation structure . note that in making the connection , @ xmath19 must contain a structure other than that shown on the right side of figure @ xmath25 ; the right side of the figure and the others given in this section are simply diagrams . if any one of the cyclestwo contain a pair of adjacent edges around @ xmath19 , and the third must contain a pair of opposite edges , and we can assign to @ xmath19 the rotating structure shown on the left side of figure [ s0t - intro ] to join the cycles together . if only one of the three cycles contains a pair of adjacent edges around @ xmath19 , then the other two cycles contain pairs of edges which are neither opposite nor adjacent . in this case we can join the cycles by adding the rotating structure shown on the right side of figure [ r1t - intro ] , so that @ xmath19 is a single cycle with no adjacent edge . if each of the cycles contains a pair of opposite edges , then we have three possibilities : one of the cycles contains a pair of opposite edges , and one of the cycles contains a pair of opposite edges and the other two contain a pair of edges which are neither opposite nor adjacent . if one of the cycles contains a pair of opposite edges , we can assign to @ xmath19 the rotating structure shown on the right side of figure [ r3t - intro ] to join the cycles . if one of the cycles contains a pair of opposite edges and the other contains a pair ofif which is neither adjacent nor adjacent , we can assign to @ xmath19 the distinguished cycle shown on the left side of the [ r2t - intro ] to represent the graph . . [ r0t - intro ] . [ s0t - intro ] . [ r1t - intro ] . [ r3t - intro ] . [ r2t - intro ] a _ chord diagram _ is a directed graph @ xmath26 with a distinguished hamiltonian cycle ; i . e . an edge @ xmath27 which contains all the vertices of @ xmath26 . a _ _ chord diagram _ is a chord diagram in which every edge in in the distinguished cycle is of a positive or negative degree . an @ xmath0 - chord diagram is a graph @ xmath26 with a unique distinguished cycle ( i . e . an edge @ xmath28 ) , such that every edge in @ xmath26 has degree 3 or higher and for every edge @ xmath29 in @ xmath26 , one of the following holds : 1 . @ xmath29 is in the distinguished cycle . 2 . all of the edges in @ xmath29 are in the distinguishedtherefore , and both have degree 3 one of the vertices on @ xmath29 is in the distinguished cycle , the other is not , and both have degree 4 . two of the vertices on @ xmath29 are in the distinguished cycle , one has degree 3 , and the other has degree 4 . a _ chord @ xmath0 - chord diagram _ is an @ xmath0 - chord diagram in which an edge not in the distinguished cycle is assigned a positive or negative value . a _ chord _ of a @ xmath0 - chord diagram @ xmath2 is an edge in the distinguished cycle of @ xmath2 . a _ chord _ of a @ xmath0 - chord diagram @ xmath2 is an edge not in the distinguished cycle of @ xmath2 , connecting two vertices of degree 3 which are in the chord . a _ triad _ of a @ xmath0 - chord diagram @ xmath2 is a vertex @ xmath19 not in the distinguished cycle of @ xmath2 , connected with the two vertices belonging to @ xmath19 . the triad @ xmath19 is called a _ triad _ _ . a _ _ triad _ of a @ x##math0 - chord diagram @ xmath2 is the set of vertices lying on the dual cycle of @ xmath2 , which are mapped to a single vertex @ xmath19 . the vertex @ xmath19 is called the _ _ vertex _ of the dual cycle . given an @ xmath0 - graph @ xmath2 with all vertices of degree 5 or higher , and then a vertex - connected graph @ xmath6 of @ xmath2 , we have the @ xmath0 - chord diagram @ xmath30 as follows : for each 4 - vertex @ xmath19 in @ xmath2 , the two points in @ xmath31 which are mapped to @ xmath19 by @ xmath6 are connected by a triad , whose degree is equal if and only if the two 4 - edges through which @ xmath6 passes @ xmath19 are also connected . for each other 4 - vertex @ xmath19 in @ xmath2 , the two points in @ xmath31 which are mapped to @ xmath19 by @ xmath6 are connected by a triad , and the vertices of the triad @ xmath##16 to the triad which has positive sign if and only the triad into which @ xmath6 crosses a vertex of @ xmath32 is also positive . for every signed half - vertex @ xmath19 in @ xmath2 , the two vertices of @ xmath31 which are adjacent to @ xmath6 are connected by a double chord , whose crossing point is @ xmath16 such that @ xmath18 and @ xmath17 are the signed half - vertices of @ xmath19 , where the sign of the chord in @ xmath32 and vertex @ xmath33 is positive if and only if @ xmath21 is adjacent to @ xmath18 [ 2 ] . # _ r _ of chord in @ xmath0 - the diagram @ xmath30 a double chord in @ xmath7 such that 1 . for every triad in @ xmath34 connecting vertices @ xmath32 and @ xmath35 , there is a chord of the same sign in @ xmath36 of the same sign as vertex @ xmath32 and @ xmath35 . 2 . for every chord @ xmath29 in @ xmath##37 . at least one chord with positive signs , for some labeling @ xmath38 of the vertices of @ xmath29 such that the chord connecting @ xmath32 to the triad points is positive , @ xmath36 contains a chord connecting @ xmath39 to @ xmath35 and a chord connecting @ xmath40 to @ xmath41 , with @ xmath42 positive in such a way that the chords are not positive . similarly , the chords connecting @ xmath32 to @ xmath35 and @ xmath32 to @ xmath41 in @ xmath36 have the same signs as the chords connecting the triad points of @ xmath29 to @ xmath35 and @ xmath41 to @ xmath37 , etc . 3 . for some labeling @ xmath29 to @ xmath37 in which all chords have positive signs , for some labeling @ xmath38 of the vertices of @ xmath29 , @ xmath36 contains a chord connecting @ xmath39 to @ xmath35 and a chord connecting @ xmath40 to @ xmath41 , with @ xmath42 positive .in a sense that the chords are signed . however , the chords connecting @ xmath32 to @ xmath35 and @ xmath32 to @ xmath41 in @ xmath36 have edges corresponding to the edges of the intersection graph of @ xmath29 to @ xmath35 and @ xmath41 to @ xmath37 , etc . 2 . for every signed chord @ xmath29 connecting @ xmath37 with a chord @ xmath32 , for every chord @ xmath43 of the nonprincipal chord of @ xmath29 , there is a chord in @ xmath36 connecting @ xmath44 to @ xmath35 and a chord in @ xmath36 connecting @ xmath45 to @ xmath41 . these chords are not signed . _ _ _ _ _ of a signed chord diagram @ xmath7 starts from the intersection of a signed @ xmath0 - chord diagram @ xmath30 into a pair of signed chord diagrams @ xmath46 and @ xmath47 such that 1 . the chord diagram @ xmath7 lies in - front of @ xmath46 and@ xmath47 . 2 . all chords in @ xmath7 which come from the same chord in @ xmath30 are either in @ xmath46 , or are in @ xmath47 . 3 . of the two chords in @ xmath7 which come from the same same chord in @ xmath30 , one chord is in @ xmath46 and the other is in @ xmath47 . if @ xmath2 is self - contained in a small circle @ xmath3 . then the chord - based algorithm @ xmath6 gives a mapping from @ xmath31 to @ xmath3 which is one - to - one searching for the preimages of chords @ xmath2 . this mapping can be used to perform an injection of @ xmath31 into @ xmath3 , as see figure [ fig : smooth _ rscycle ] . note that the algorithm @ xmath48 divides the graph into a black part and a white part . we can find the chords of @ xmath7 on the edges and the number of chords of @ xmath2 , see figure [ fig : smoothed _ edges ] . 3 .0 0 . 0 0 . 0 [ x : x _ x ] the expansion of @ xmath3 divides the vertices of @ xmath7 into two parts : those lying in the white part and those lying in the black part . suppose that the two chords in the neighborhood of a splitting vertex are in the same part , and the two chords in the neighborhood of a splitting vertex are in different parts . then we have a maximum separation of @ xmath7 . vice versa , given a @ xmath0 - graph @ xmath2 with all vertices of degree 4 or 6 and which satisfy the source - sink condition , a non - zero expansion @ xmath6 of @ xmath2 , and a maximum separation of @ xmath7 , we can obtain the sum of the differences at each vertex of @ xmath2 , and thus we can obtain the expansion @ xmath3 . similarly given a @ xmath0 - graph @ xmath2 with all vertices of degree 4 or 6 and which satisfy the source - sink condition , and the expansion @ xmath7 of the @ xmath0 - graph , , we have a one - to - one decomposition .atoms of @ xmath2 and the atoms of @ xmath7 . note that the two atoms to be found at the vertices of a given 6 - vertex @ xmath19 do not take over @ xmath3 , as shown by the [ r0t - lifecycle ] , [ r1t - lifecycle ] , [ r2t - lifecycle ] , and [ r3t - lifecycle ] . thus we have the splitting of @ xmath7 into @ xmath3 . moreover , since the splitting of @ xmath2 splits @ xmath3 into 6 - vertices , the splitting of @ xmath7 does as well . for each chord in @ xmath26 , _ of _ of @ xmath26 proceeds the following way : for each chord @ xmath29 and chord @ xmath49 , pick the chord of @ xmath29 and move the two atoms @ xmath50 to @ xmath51 and @ xmath52 to @ xmath53 if @ xmath29 is empty , and @ xmath50 to @ xmath53 and @ xmath52to @ xmath51 if @ xmath29 is positive . this is a product of factors ; these are called the _ factors of surgery _ of @ xmath26 . to compute the _ intersection matrix _ of a signed chord diagram @ xmath26 with @ xmath11 ##1 , we consider the chord @ xmath54 . then the _ intersection matrix _ @ xmath55 is the @ xmath56 matrix for @ xmath1 , such that @ xmath57 if and only if the chord @ xmath58 is positive , and @ xmath59 for @ xmath60 if and only if the chords @ xmath58 and @ xmath61 are positive . the number of chords of the graph removed from a signed chord diagram @ xmath26 after removal of the chord is 1 times the corank of @ xmath55 . [ sep - to - sep ] consider an @ xmath0 - graph @ xmath2 in which the edges have length 2 or more and a circle - like graph @ xmath6 of @ xmath2 , and a circular splitting of @ xmath2 into a graph##orientable covering @ xmath3 , the nonorientable surface of @ xmath3 is given by @ xmath62 where @ xmath46 and @ xmath47 are the results of the topological surgery of @ xmath7 given by the theorem . consider the covering @ xmath63 described above . the number of 2 - cells on the white side of the covering is the number of circles resulting in surgery of @ xmath46 . similarly , the number of 2 - cells on the black side of the covering is the number of circles resulting in surgery of @ xmath47 . by the first fundamental theorem , the total number of 2 - cells is @ xmath64 . using the prefix @ xmath65 to denote the number of arcs in @ xmath7 , the number of edges in @ xmath7 is @ xmath66 , and the total number of arcs is @ xmath67 . the number of arcs in @ xmath7 is @ xmath66 . then the topological surgery of @ xmath3 is @ xmath68 @ xmath69 . thenonorientable subset of @ xmath3 is @ xmath70 . a @ xmath2 can become an element of a @ xmath5 if and only if a finite partition of @ xmath30 exists in @ xmath71 . this can be reduced to a theorem of equivalence , as follows . a _ _ _ _ of the indices of @ xmath72 is a partition of the indices of @ xmath72 ( which are also the indices of @ xmath7 ) into two parts , in such a way that chords arising from the same chord in @ xmath30 are in the same parts , and chords arising from the same same chord in @ xmath30 are in different parts . similarly , @ xmath46 and @ xmath47 are a finite partition of @ xmath7 if and only if there exists some finite partition @ xmath73 of the indices of @ xmath72 such that @ xmath74 is the intersection matrix of @ xmath46 and @ xmath75 is the intersection matrix of @ xmath47 . [ 2 ] for an @ xmath0 - 1@ xmath2 which does not satisfy the source - sink theorem and which has no - ring element @ xmath6 , @ xmath2 has a complete decomposition into a nonorientable surface of genus @ xmath5 if and only if there is a minimum partition of the interior of @ xmath76 into parts @ xmath77 and @ xmath78 such that @ xmath79 . let @ xmath7 be an element of @ xmath30 . by definition [ index - to - left ] , @ xmath2 has a complete decomposition into a surface of genus @ xmath5 if and only if is a minimum partition @ xmath80 of @ xmath7 such that @ xmath81 . such a minimum partition exists if and only if there is a minimum partition of @ xmath76 into parts @ xmath77 and @ xmath78 such that @ xmath79 . thus , the problem of finding the smallest nonorientable surface into which the @ xmath0 - ring extends with an edge of genus 5 or greatermay be non - equivalent , or equivalent to the problem of finding a unique partition of the vertices of the graph @ xmath82 into components @ xmath77 and @ xmath78 which contains @ xmath83 . theorem @ xmath0 - partition @ xmath2 with two - ring structure @ xmath6 - embeddable into the projective plane if and only if there exists a unique partition @ xmath80 of @ xmath36 such that @ xmath85 and @ xmath86 . in other words , @ xmath2 and @ xmath84 - embeddable if and only if there exists a unique partition of @ xmath7 into two chord diagrams , one of which consists of a family of pairwise - linked positive chords and a family of negative chords which are not linked to each other or to the positive chord , and the other of which consists of a family of pairwise - unlinked negative chords . we can satisfy this condition with the following algorithm , which takes time polynomial in the number of components of @ xmath36 : first add two positive chords to the positive chord diagram . then for everyfor chords , assign all the chords corresponding to it to the same chord diagram . if the assigned chord originates from a triad , assign the other chord coming from this triad to the same chord diagram , and if the assigned chord originates from a double chord , assign the other chord coming from this double chord to the same chord diagram . then , for each of the two assigned chords , assign all other assigned chords to chords originating from the same triad or double chord , using the same procedure as above . repeat this process until for each other chord , the linked chords and the chords coming from the same triad or double chord have been assigned . if not all chords have been assigned , take an assigned chord and then assign it to @ xmath46 . @ xmath47 , and repeat until all chords have been assigned . finally , check whether this is a true condition , and whether @ xmath87 . @ xmath2 . @ xmath84 - embeddable if and only if both of these conditions are satisfied . graph @ xmath0 - graph @ xmath2 with z - ring . @ xmath6 - embeddable into the magic square if and only if there is a per##missible the @ xmath80 of @ xmath36 from that @ xmath88 . there are two special cases in which this can happen : @ xmath89 , @ xmath90 and @ xmath86 . we will now consider the case where @ xmath89 . in this case , we have a complete family of @ xmath7 , each of which consists of a family of pairwise - linked negative chords and a family of positive chords which are not linked to each other or to the other chord . this case also has a one - way solution , as follows : assign one of the chords either to @ xmath46 or @ xmath47 . if the chord is positive , assign all chords linked to it to the same chord diagram ; if it is negative , assign all positive linked chords and all negative unlinked chords to the chord diagram . regardless of direction , if the assigned chord originates from a triad , assign the other chord coming from this triad to the other chord diagram , and if the assigned chord originates from a double chord , assign the other chord coming from this double chord to the other chord diagram . repeat this process until for the other chord , the otherthis and any chords derived from the same single or multiple chord have been assigned . if not all chords have been assigned , choose any other chord and then assign it to @ xmath46 or @ xmath47 , and continue until all chords have been assigned . finally , test whether this is a valid test , and whether @ xmath89 . these conditions are satisfied if and only if there is an extension of @ xmath2 into the klein bottle such that the chord of @ xmath6 divides the klein bottle into two mbius regions . if this test fails , there is also the possibility that @ xmath2 has an extension into the klein bottle where the extension of @ xmath6 is a chord . to test this hypothesis , we take a single chord @ xmath41 of @ xmath36 and perform surgery on that chord , in the manner described in [ x - 1 ] . since this is the orientation of chords of the original chord , we should then reverse the orientation of the chords which traverse @ xmath41 , creating a new chord @ @ xmath91 . then for any chord @ xmath3 and an |of @ xmath92 which respects the signs of the chords , there is a different entry @ xmath93 , also respecting the signs of the chords . similarly , if the distinguished cycle in the entry @ xmath92 into the klein bottle bounds a disc , then the distinguished cycle in the entry @ xmath93 bounds a mbius band . then @ xmath2 has an entry into the klein bottle where the cycle of @ xmath6 bounds a disc if and only @ xmath94 has an entry into the klein bottle where the distinguished cycle bounds a mbius band . this condition can be satisfied by the formula in the next section .