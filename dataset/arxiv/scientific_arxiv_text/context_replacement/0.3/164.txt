a _ @ xmath0 - graph _ is a graph which at each vertex has a bijection from the outgoing half - edges to the vertices of the cycle graph . half - edges which are mapped to adjacent vertices are ( formally ) _ opposite _ . half - edges are said to be _ opposite _ if they are mapped to vertices of equal degree of the cycle graph . by an instance of an @ xmath0 - graph @ xmath2 into a surface @ xmath3 we can mean an instance of @ xmath2 into @ xmath3 such that the formal relation of being adjacent agrees with the relation of being adjacent enclosed by the surface . an _ edge _ of an @ xmath0 - graph has a pair of outgoing half - edges at each vertex . a _ checkerboard graph _ of a @ xmath0 - graph @ xmath2 into @ xmath3 is an embedding such that the edges of @ xmath4 have a two - coloring under which all cells with a single color have two colors . edge embeddings are exactly those embeddings whose edges @ xmath1 - edgeit is free . in @ xcite the second named author ( t . f . m . ) gave a solution to the question of whether four - valent framed graphs are embedded . in @ xcite , he addressed the question of determining the genera of surfaces into which four - vertex framed graphs may be embedded , in particular considering the special genera of surfaces into which four - valent framed graphs may be self - embedded . in @ xcite , the third named author ( f . m . ) introduced @ xmath0 - graphs as a generalization of four - vertex framed graphs , and introduced a planarity property for @ xmath0 - graphs with each vertex of degree 4 or 6 . in @ xcite , the authors defined the class of orientable surfaces into which @ xmath0 - graphs with each vertex of degree 4 or 6 may be checkerboard - embedded , extending some of the results of @ xcite . in this paper , we continue the process of generalizing results about embeddability properties of @ four - valent graphs to @ xmath0 - graphs with each vertex of degree 4 or 6 , now extending checkerboard - embeddability into nonorientable surfaces. in figure [ 1 ] we show that this is equivalent to a problem on matrices . our methods are close to those used in our earlier paper @ xcite , which were themselves based closely on those used by the first main author ( v . a . k . ) of @ xcite for the two - valent case . the goal of this paper is to find a method for determining whether a graph @ xmath0 - of @ xmath2 has a checkerboard embedding into the nonorientable graph of graph @ xmath5 . we show that this is equivalent to a problem on matrices . to prove this , we construct a graph @ xmath6 of @ xmath2 satisfying certain conditions , called a rotating - splitting graph . then we construct a correspondence between the embeddings of @ xmath2 and ` ` permissible separations ' ' of the chord graph @ xmath7 , where the result of a rotation operation is a pair of chord diagrams . we then show that the number of colored ( black ) circles in the graph is equal to the number of circles obtained from surgery of the edges ( black ) of these chord diagrams . the circuit - splitting graph .and to calculate the number of circles resulting from surgery of each vertex diagram in terms of the sum of their rotation ##s _ @ xmath1 . from this we obtain the total number of circles in the embedding , from which the area @ xmath5 of the sphere can be easily calculated . the authors of this article would like to thank vladimir anatolievich vassiliev and sergei vladimirovich chmutov for valuable discussions . a _ @ xmath0 - atom _ is a closed 2 - sphere @ xmath3 into which a directed graph @ xmath2 ( the _ skeleton _ of the @ xmath0 - atom ) is embedded in such a way that it divides @ xmath3 into black and white cells so that cells sharing an edge have different colors . this partition forms an @ xmath0 - structure at the skeleton . the @ xmath0 - structure at each vertex determines a set of @ xmath8 vertices among which we say that two vertices are adjacent if they share a half - angle . two half angles always have the same color . thus the area at each vertex can be partitioned into two triangles @ xmath9 and @ xmath10 .such a means that for each @ xmath0 - atom corresponding to the @ xmath0 - graph @ xmath2 , either all angles in @ xmath9 are black and all angles in @ xmath10 are white , or all angles in @ xmath9 are white and all angles in @ xmath10 are black . now given a connected @ xmath0 - graph @ xmath2 , the @ xmath0 - atoms corresponding to @ xmath2 are all determined by the choice of one of the two possible colors for each vertex . thus the main problem can be reformulated as follows : given a @ xmath0 - graph @ xmath2 in which all vertices have genus 4 or 5 , choose a coloring for the angles around each vertex such that the size of the resulting graph is minimal . if such a graph has @ xmath11 vertices , so are @ xmath12 and @ xmath0 - graphs . the _ euler circuit _ @ xmath6 of an @ xmath0 - graph @ xmath2 is a surjective circuit @ xmath13 which is one - to - one except at the edges ,and such that every polynomial of degree @ xmath8 has @ xmath14 preimages . given an euler circuit @ xmath6 of an @ xmath0 - graph @ xmath2 , a 6 - vertex @ xmath15 is _ rotating _ with respect to @ xmath6 if for some @ xmath16 , @ xmath17 and @ xmath18 are on adjacent half - edges around @ xmath19 . given an alternating circuit @ xmath6 of a @ xmath0 - graph @ xmath2 , a 6 - vertex @ xmath15 is _ splitting _ with respect to @ xmath6 if for every @ xmath16 , @ xmath17 and @ xmath18 are on opposite half - edges around @ xmath19 . given an euler circuit @ xmath6 of an @ xmath0 - graph @ xmath2 , a 6 - vertex @ xmath15 is _ splitting _ with respect to @ xmath6 if for every @ xmath16 , @ xmath17 and @ xmath18 are on opposite half - edges around @ xmat##h19 , and for the first three vertices @ xmath20 , @ xmath21 and @ xmath22 are on adjacent half - edges , and @ xmath23 and @ xmath24 are on adjacent half - edges . a _ rotating - splitting circuit _ is a circuit with edges to which each vertex is rotating - splitting . a rotating - splitting circuit induces an orientation on the half - edges of a single 6 - vertex . if the orientation of the edges of @ xmath17 and @ xmath18 agrees with this orientation , then the angle is _ be _ twisted _ ; otherwise it is _ rotated _ . see also [ r0 t ] , [ r1 t ] , [ r2 t ] , [ r3 t ] . [ rscycle - graph ] if @ xmath2 is a connected @ xmath0 - graph in which the edges have order 4 or 5 , then @ xmath2 admits a rotating - splitting circuit . add to each vertex a rotating - splitting circuit . this is a partition of the edges of @ xmath2 into edgewise independent cycles . if there is only one such cycle , we are done . if there are morethan a cycle , since the graph is connected , there must be a vertex @ xmath19 connected by different cycles . if @ xmath19 has degree 4 , it must be connected , and we can join the two cycles meeting at @ xmath19 , adding to @ xmath19 the highest possible rotation structure . if @ xmath19 has degree 5 , we join the cycles given by meeting at @ xmath19 , starting at one of the incident vertices , and following the cycle - rotation structure until we come back to @ xmath19 . there are three such cycles , up to a change in degree . if each of these cycles contains a pair of incident vertices at @ xmath19 , we can assign to @ xmath19 the rotation structure shown on the right side of figure [ r0t - 2 ] , so that the three cycles are joined together , and @ xmath19 becomes a single cycle with different rotation structure . note that by making the rotation , @ xmath19 may have a structure other than that shown on the left side of figure @ xmath25 ; the left side of the figure and the others referenced in this article are only examples . if exactly one of the twocycles contain a pair of adjacent edges around @ xmath19 , and the vertices must contain a pair of opposite edges , and we can assign to @ xmath19 the splitting structure shown on the left side of figure [ s0t - intro ] to join the cycles together . if only one of the three cycles contains a pair of adjacent edges around @ xmath19 , then the other two cycles contain pairs of edges which are neither opposite nor adjacent . in this case we can join the cycles by adding the splitting structure shown on the right side of figure [ r1t - intro ] , so that @ xmath19 becomes a single cycle with one rotation each . if none of the cycles contains a pair of adjacent edges , then we have three cycles : each of the cycles contains a pair of opposite edges , and one of the cycles contains a pair of opposite edges and the other cycles contain a pair of edges which are neither opposite nor adjacent . if each of the cycles contains a pair of opposite edges , we can assign to @ xmath19 the rotating structure shown on the right side of figure [ r3t - intro ] to join the cycles . if one of the cycles contains a pair of opposite edges and the other contains a pair ofcycles which are neither distinct nor distinct , we can add to @ xmath19 the graph as shown on the right side of figure [ r2t - intro ] to represent the cycles . . [ r0t - intro ] . [ s0t - intro ] . [ r1t - intro ] . [ r3t - intro ] . [ r2t - intro ] a _ chord diagram _ is a cubic graph @ xmath26 with a distinguished hamiltonian cycle ; i . e . an edge @ xmath27 which covers all the vertices of @ xmath26 . a _ _ chord diagram _ is a chord diagram in which each edge not in the distinguished cycle is assigned a positive or negative sign . an @ xmath0 - chord diagram is a graph @ xmath26 with a distinguished simple cycle ( i . e . an edge @ xmath28 ) , such that every vertex in @ xmath26 has degree 3 or higher and for every edge @ xmath29 in @ xmath26 , one of the following holds : 1 . @ xmath29 is in the distinguished cycle . 2 . both of the edges in @ xmath29 are in the distinguishedcycle , and both have degree 3 one of the vertices on @ xmath29 is in the distinguished cycle , the other is not , and both have degree 3 . both of the vertices on @ xmath29 are in the distinguished cycle , one has degree 3 , and the other has degree 3 . a _ signed @ xmath0 - chord diagram _ is an @ xmath0 - chord diagram in which a vertex not in the distinguished cycle is assigned a positive or negative sign . an _ arc _ of a @ xmath0 - chord diagram @ xmath2 is an edge in the distinguished cycle of @ xmath2 . a _ arc _ of a @ xmath0 - chord diagram @ xmath2 is an edge not in the distinguished cycle of @ xmath2 , connecting two vertices of degree 3 which are in the chord . a _ chord _ of a @ xmath0 - chord diagram @ xmath2 is a vertex @ xmath19 not in the distinguished cycle of @ xmath2 , connected with the two vertices incident to @ xmath19 . the triad @ xmath19 is called a _ double point _ . a _ double chord _ of a @ x##math0 - chord diagram @ xmath2 is a pair of vertices not on the distinguished cycle of @ xmath2 , which are incident to a single vertex @ xmath19 . the vertex @ xmath19 is called the _ principal vertex _ of the distinguished cycle . given an @ xmath0 - circuit @ xmath2 with four vertices of degree 5 or higher , and given a vertex - connected circuit @ xmath6 of @ xmath2 , we have the @ xmath0 - chord diagram @ xmath30 as follows : for any 4 - vertex @ xmath19 in @ xmath2 , the two points in @ xmath31 which are mapped to @ xmath19 by @ xmath6 are connected by a triad , whose sign is positive if and only if the two half - edges through which @ xmath6 enters @ xmath19 are not connected . for any other 4 - vertex @ xmath19 in @ xmath2 , the two points in @ xmath31 which are mapped to @ xmath19 by @ xmath6 are connected by a triad , and the chord connecting a vertex @ xmath##16 to the final point has positive sign if and only the chord into which @ xmath6 crosses a vertex of @ xmath32 is not positive . for any splitting half - vertex @ xmath19 in @ xmath2 , the two vertices of @ xmath31 which are adjacent to @ xmath6 are connected by a double chord , whose central vertex is @ xmath16 such that @ xmath18 and @ xmath17 are on the half - vertex of @ xmath19 , where the sign of the edge in @ xmath32 another vertex @ xmath33 is positive if and only if @ xmath21 is adjacent to @ xmath18 [ figure ] . the _ expansion _ of _ signed @ xmath0 - 2 in @ xmath30 a double chord in @ xmath7 such that 1 . for every triad in @ xmath34 containing vertices @ xmath32 and @ xmath35 , there is a chord of the same sign in @ xmath36 of the same sign containing vertices @ xmath32 and @ xmath35 . 2 . for every triad @ xmath29 in @ xmath##37 containing at least one edge with positive sign , for some labeling @ xmath38 of the vertices of @ xmath29 in that the edge connecting @ xmath32 to the triad point is positive , @ xmath36 contains a chord connecting @ xmath39 to @ xmath35 and a chord connecting @ xmath40 to @ xmath41 , with @ xmath42 chosen in such a way that the chords are all linked . similarly , the chords connecting @ xmath32 to @ xmath35 and @ xmath32 to @ xmath41 in @ xmath36 have the same sign as the edges connecting the triad points of @ xmath29 to @ xmath35 and @ xmath41 to @ xmath37 , respectively . 3 . for some labeling @ xmath29 in @ xmath37 in which all edges have positive sign , for some labeling @ xmath38 of the vertices of @ xmath29 , @ xmath36 contains a chord connecting @ xmath39 to @ xmath35 and a chord connecting @ xmath40 to @ xmath41 , with @ xmath42 chosen .such a way that the chords are linked . furthermore , the chords connecting @ xmath32 to @ xmath35 and @ xmath32 to @ xmath41 in @ xmath36 have vertices corresponding to the chords of the triad ##s of @ xmath29 to @ xmath35 and @ xmath41 to @ xmath37 , etc . 4 . for every signed chord @ xmath29 in @ xmath37 with principal vertex @ xmath32 , for every subset @ xmath43 of the nonprincipal vertices of @ xmath29 , there is a chord in @ xmath36 connecting @ xmath44 to @ xmath35 and a chord in @ xmath36 connecting @ xmath45 to @ xmath41 . these chords are also connected . 5 _ permissible separation _ of a signed chord diagram @ xmath7 _ from an instance of a signed @ xmath0 - chord diagram @ xmath30 to a pair of signed chord diagrams @ xmath46 and @ xmath47 such that 1 . every chord diagram @ xmath7 contains exactly exactly one of @ xmath46 and@ xmath47 . 2 . two chords in @ xmath7 which come from the same triad in @ xmath30 are either in @ xmath46 , or both in @ xmath47 . 3 . of the two chords in @ xmath7 which come from the same double chord in @ xmath30 , one chord is in @ xmath46 and the other is in @ xmath47 . then @ xmath2 is checkerboard - shaped in the smooth circle @ xmath3 . then the rotating - ring circuit @ xmath6 has a mapping from @ xmath31 to @ xmath3 which is one - to - one only on the preimages of chords @ xmath2 . this mapping can be used to give an embedding of @ xmath31 into @ xmath3 , as see figure [ fig : smoothed _ rscycle ] . suppose that the circle @ xmath48 divides the chord into a black part and a white part . we can draw the chords of @ xmath7 on small circles located in neighborhoods of vertices of @ xmath2 , see figure [ fig : smoothed _ rs ] . 3 .3 0 . 3 0 . 3 [ note : small _ size ] the coloring of @ xmath3 divides the chords of @ xmath7 into two families : those lying in the white part and those lying in the black part . observe that the two chords in the neighborhood of a rotating vertex are in the same part , and the two chords in the neighborhood of a rotating vertex are in different parts . thus we have a complete separation of @ xmath7 . vice versa , given a @ xmath0 - graph @ xmath2 with all vertices of degree 4 or 6 and which satisfy the source - sink condition , a rotating - edge circuit @ xmath6 of @ xmath2 , and a ##missible expansion of @ xmath7 , we can recover the coloring of the angles of each edge of @ xmath2 , and thus we can recover the coloring @ xmath3 . thus given a @ xmath0 - graph @ xmath2 with all vertices of degree 4 or 6 and which satisfy the source - sink condition , and an expansion @ xmath7 of the @ xmath0 - chord diagram , we have a one - to - one correspondence betweenatoms of @ xmath2 and the atoms of @ xmath7 . note that the two lines to be drawn in the direction of a given 2 - part @ xmath19 do not intersect at @ xmath3 , as shown by the [ r0t - lifecycle ] , [ r1t - lifecycle ] , [ r2t - lifecycle ] , and [ r3t - lifecycle ] . thus we have an intersection of @ xmath7 into @ xmath3 . moreover , since the neighborhood of @ xmath2 divides @ xmath3 into 2 - parts , the embedding of @ xmath7 does as well . given a neighborhood of @ xmath26 , _ surgery _ of @ xmath26 performs the following function : for a chord @ xmath29 that crosses @ xmath49 , take the neighborhood of @ xmath29 and add the corresponding chord @ xmath50 to @ xmath51 and @ xmath52 to @ xmath53 if @ xmath29 is removed , and @ xmath50 to @ xmath53 and @ xmath52to @ xmath51 if @ xmath29 is positive . this is a sequence of operations ; these are called the _ operations of surgery _ of @ xmath26 . to compute the _ intersection matrix _ of a signed chord diagram @ xmath26 with @ xmath11 ##1 , we consider the chord @ xmath54 . then the _ intersection matrix _ @ xmath55 is an @ xmath56 matrix for @ xmath1 , such that @ xmath57 if and only if the chord @ xmath58 is negative , and @ xmath59 for @ xmath60 if and only if the chords @ xmath58 and @ xmath61 are positive . the number of chords in the graph obtained from a signed chord diagram @ xmath26 by removal of the chord is one of the corank of @ xmath55 . [ sep - to - sep ] given an @ xmath0 - graph @ xmath2 in which all vertices have degree 5 or higher and a half - circle graph @ xmath6 of @ xmath2 , and the checkerboard graph of @ xmath2 into a non##orientable surface @ xmath3 , the nonorientable genus of @ xmath3 is given by @ xmath62 where @ xmath46 and @ xmath47 are the components of the total genus of @ xmath7 given by the genus . consider the surface @ xmath63 described above . the number of 2 - cells on the white side of the embedding is the number of circles resulting in surgery of @ xmath46 . similarly , the number of 2 - cells on the black side of the embedding is the number of circles resulting in surgery of @ xmath47 . by the universal design theorem , the total number of 2 - cells is @ xmath64 . using the notation @ xmath65 to denote the number of edges in @ xmath7 , the number of arcs in @ xmath7 is @ xmath66 , so the total number of arcs is @ xmath67 . the number of edges in @ xmath7 is @ xmath66 . thus the genus characteristic of @ xmath3 is @ xmath68 @ xmath69 so thenonorientable genus of @ xmath3 is @ xmath70 . thus @ xmath2 has become an atom of genus @ xmath5 if and only if some permissible partition of @ xmath30 is in @ xmath71 . this can be reduced to a system of matrices , as follows . a _ permissible partition _ of the indices of @ xmath72 is a partition of the indices of @ xmath72 ( which are also the indices of @ xmath7 ) into two parts , in such a way that chords arising from the same chord in @ xmath30 are in the same parts , and chords arising from the same same chord in @ xmath30 are in different parts . similarly , @ xmath46 and @ xmath47 have a _ genus of @ xmath7 if and only if there is a _ partition @ xmath73 of the indices of @ xmath72 such that @ xmath74 is the intersection matrix of @ xmath46 and @ xmath75 is the intersection matrix of @ xmath47 . [ 2 ] for an @ xmath0 - index@ xmath2 which does not satisfy the source - sink relation and which has rotating - splitting circuit @ xmath6 , @ xmath2 has a circle splitting into a nonorientable surface of genus @ xmath5 if and only if there is a minimum partition of the surface of @ xmath76 into parts @ xmath77 and @ xmath78 such that @ xmath79 . let @ xmath7 be any subset of @ xmath30 . by proceeding [ sep - to - sep ] , @ xmath2 has a checkerboard embedding into a surface of genus @ xmath5 if and only there is a minimum separation @ xmath80 of @ xmath7 such that @ xmath81 . such a permissible separation exists if and only if there is a minimum partition of @ xmath76 into parts @ xmath77 and @ xmath78 such that @ xmath79 . thus , the problem of finding the minimal nonorientable surface into which the @ xmath0 - cycle goes with an edge of genus 4 or higherto be checkerboard - embedded , is equivalent to the problem of finding a permissible partition of the diagonal of a matrix @ xmath82 into components @ xmath77 and @ xmath78 which contains @ xmath83 . theorem @ xmath0 - matrix @ xmath2 with rotating - splitting circuit @ xmath6 is embeddable into the projective plane if and only if there exists a minimum partition @ xmath80 of @ xmath36 such that @ xmath85 and @ xmath86 . in other words , @ xmath2 and @ xmath84 - embeddable if and only if there exists a minimum partition of @ xmath7 into two chord diagrams , one of which consists of a family of pairwise - linked negative chords and a family of positive chords which are not connected to each other or to the negative chords , and the other of which consists of a family of pairwise - unlinked positive chords . we can test this condition with the following algorithm , which takes time quadratic in the number of copies of @ xmath36 : first add all positive chords to the first chord diagram . then for everyassigned chord , assign all the chords linked to it to the other chord diagram . if an assigned chord originates from a triad , assign the other chords coming from this triad to the other chord diagram , and if the assigned chord originates from a double chord , assign the other chord coming from this double chord to the same chord diagram . then , for each of the newly assigned chords , assign any other linked chords or chords coming from the same triad or double chord , using the same rules as before . repeat this process until for each new chord , the linked chords and any chords coming from the same triad or double chord have been assigned . if not all chords have been assigned , find the other chord and then assign it to @ xmath46 . @ xmath47 , and repeat until all chords have been assigned . finally , check whether this is a proper assignment , and whether @ xmath87 . @ xmath2 . @ xmath84 - embeddable if and only if both of these statements are true . a @ xmath0 - graph @ xmath2 with rotating - ring . @ xmath6 is embeddable into the empty set if and only if there exists a per##missible separation @ xmath80 of @ xmath36 from that @ xmath88 . there are two other cases in which this can occur : @ xmath89 , @ xmath90 and @ xmath86 . we will first consider the case where @ xmath89 . in this case , we have a possible separation of @ xmath7 , each of which consists of a family of pairwise - linked negative chords and a family of positive chords which are not linked to each other or to the negative chords . this case also has a one - time test , as follows : assign one of the chords belonging to @ xmath46 and @ xmath47 . if the chord is positive , assign all chords linked to it to the other chord diagram ; if it is negative , assign all positive linked chords and all negative unlinked chords to the chord diagram . regardless of order , if the assigned chord originates from a triad , assign the other chord coming from this triad to the same chord diagram , and if the assigned chord originates from a double chord , assign the other chord coming from this double chord to the other chord diagram . repeat this process until for every assigned chord , the otherchords and all chords coming from the same single or multiple chord have been assigned . if not all chords have been assigned , take any other chord and arbitrarily assign it to @ xmath46 and @ xmath47 , and continue until all chords have been assigned . finally , test whether this is a permissible separation , and whether @ xmath89 . these conditions are met if and only if there is an embedding of @ xmath2 into the klein bottle such that a smoothing of @ xmath6 divides the klein bottle into two mbius bands . if this test fails , there is still the possibility that @ xmath2 has an embedding into the klein bottle where the smoothing of @ xmath6 bounds a chord . to cover this possibility , we take a negative chord @ xmath41 of @ xmath36 and perform surgery on that chord , in the way shown in [ x - surgery ] . since this reverses the shape of part of the negative chord , we should also reverse the shape of the chords which intersect @ xmath41 , creating a new chord diagram @ xmath91 . then for any surface @ xmath3 and an xof @ xmath92 which respects the signs of the chords , there is a corresponding embedding @ xmath93 , also respecting the signs of the chords . similarly , if the distinguished cycle in the embedding @ xmath92 into the klein bottle bounds a disc , then the distinguished cycle in the smoothing @ xmath93 bounds a mbius band . then @ xmath2 has an embedding into the klein bottle where the smoothing of @ xmath6 bounds a disc if and only @ xmath94 has an entry into the klein bottle where the distinguished cycle bounds a mbius band . this condition can be checked using the algorithm in the previous paragraph .