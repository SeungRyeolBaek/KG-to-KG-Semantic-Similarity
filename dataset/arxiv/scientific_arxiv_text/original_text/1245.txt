the light source of our experiment is a continuous - wave ( cw ) ti : sapphire laser operating at the wavelength of 860 nm .
in addition to the setup shown in fig .
1a , there are two optical cavities which are omitted from fig .  1a .
one cavity is a second - harmonic generator , which is a bow - tie - shaped cavity and contains a periodically - poled ktiopo@xmath1 ( ppktp ) crystal as a nonlinear optical medium . the resulting continuous output beam at the wavelength of 430 nm is , after a frequency shift by an acousto - optic modulator , directed as a pump beam to each memory cavity , which contains a periodically - poled ktiopo@xmath1 ( ppktp ) crystal as a nonlinear optical medium and works as a non - degenerate optical parametric oscillator ( nopo ) .
the pumping power at each memory cavity is about 3 mw .
optionally , the pump beams can be individually blocked after a herald in order to prevent further production of photons , but this was not employed in this demonstration , because the probability of such unwanted events is small .
the other cavity is a mode - cleaning cavity , by which the transverse mode of the local oscillators is purified to a tem@xmath2 mode in order to maximize the interference visibility at the homodyne detections .
the power of each local oscillator is about 18 mw .    the concatenated - cavity - based memory systems ( memory-1 , memory-2 ) have the same design , similar to our previous experiment @xcite but with parameters slightly different from before .
the design of the concatenated - cavity - based memory system is as follows .
the transmissivity of the coupling mirror that couples the memory cavity and the shutter cavity is 1.6 % and the transmissivity of the outcoupling mirror at the exit of the shutter cavity is 24.7% .
the former transmissivity corresponds to a compromise between long lifetime and phase - locking stability , while the latter is set in accordance with the former in order to operate the system nearly at the critical damping condition @xcite .
the memory cavity has a free spectrum range ( fsr ) of 214.1 mhz .
spontaneous parametric down conversion inside the memory cavity produces signal and idler photons which are separated by this fsr .
the shutter cavity contains an electro - optic modulator ( eom ) , which is a rbtiopo@xmath1 ( rtp ) crystal with an aperture size of 4 mm @xmath3 4 mm .
it is driven by a high - voltage switch ( bergmann messgerte entwicklung kg ) , whose voltage is around 900 v to match the frequency shift to the fsr of the memory cavity .    in order to stabilize the whole setup ,
all of the resonant frequencies of the cavities and the phases of the local oscillators are each electronically controlled by using a feedback loop .
each controller is composed of an analog feedback controller , an error detector of locking , and a digital scanner for the error recovery .
the error detection signals from all of the controllers are brought together by logical or gates , and then sent to the timing controller in order to pause the measurement when there is an error .
the timing controller is a field - programmable gate array ( fpga ) ( virtex-4 , xilinx ) , which processes the heralding signals and controls the timing of the photon release .
the same timing controller actually also controls the sequence of the switching between the feedback phase and the measurement phase , as explained below . for the analog feedback control ,
we monitor the optical systems by means of bright beams .
however , such bright beams , except for the local oscillator beams and the pump beams , represent an extra complication in our single - photon - level experiment .
therefore we cyclically switch the optical systems .
one phase is the feedback phase where the bright beams are injected to the cavity systems .
the other is the measurement phase where the bright beams are blocked and the two - photon interference is tested .
the switching rate is 5 khz , and the duty cycle is 40% for the measurement phase .
as mentioned above , the fpga controls the release timing of photons .
the fpga clock frequency is 100 mhz , and thus , in our system , the release timings are synchronized with 10 ns intervals .
note that the timing jitter of the driving signals in the timing controller was negligibly small ( less than 1 ns ) , compared to the width of the wavepackets of photons ( about 100 ns ) .
the photon arrival times of the two inputs are matched by adjusting the electric cable lengths from the timing controller to the eoms , as well as the optical path lengths from the exits of the shutter cavities to the balanced beam splitter of the hom interferometer .
the lengths of the two output arms to the data - storage oscilloscope are also matched .
these were tested in the preliminary experiment .    in the hom experiment ,
the photons are released when both heralding events of memory-1 and memory-2 happen within 2 @xmath4 .
if the second herald does not occur by 2 @xmath4 , the timing controller becomes idle and waits for 5 @xmath0s , which is long enough compared to the memory lifetime of about 2 @xmath0s . during this dead time ,
the heralded photon is almost lost and the memory systems are almost initialized again .
in the preliminary experiment , we tested our memory systems by using a highly reflective mirror as the replaceable mirror ( rm ) . for each memory-@xmath5 , we repeated single - photon generation and homodyne detection 43,404 times for each variable set storage time @xmath6 after the herald , changed from 0 ns to 500 ns at 50-ns intervals . from the results , we estimated the shapes of the wavepackets @xmath7 by utilizing principal component analysis @xcite , as shown in fig .  1b , and calculated the single - photon purities @xmath8 ( corresponding to the respective single - photon fractions ) , as shown in fig .
the single - photon purities are shown to degrade for longer storage times indicating a finite memory lifetime , but the wigner - function - negativity condition @xcite with purities above 0.5 is still satisfied for up to about 0.4  @xmath0s . as shown in fig .
1c , the maximum storage time @xmath9 of the synchronization can be set much longer than this 0.4  @xmath0s , thus preserving the negativity .
the shapes of the estimated wavepackets @xmath7 , shown in fig .  1b , are independent of @xmath6 , excluding pre - leakage .
furthermore , they are almost the same between memory-1 and memory-2 .
the overlap @xmath10 was 0.992 .
we defined the signal wavepacket for the hom experiment as an average temporal mode : @xmath11/ \sqrt{\int dt | f_1(t ; 0 ) + f_2(t ; 0)|^2}$ ] .
the overlap between the signal wavepacket and the estimated wavepacket released from the individual memory-@xmath5 after @xmath6 , defined as @xmath12 , was larger than 0.96 for up to @xmath6 = 500 ns , as listed in supplementary table  [ table : modefunction ] .
this high value contributes to the visibility of the hom interference and the purities of the input states .
the estimated purities @xmath8 corresponding to the estimated wavepackets @xmath7 in fig .
1bare listed in table  [ table : modefunction ] , corresponding to the exact values of the points in fig .  s1a .
in order to exclude the influence of the mode mismatches on the input purities , we also calculated purities @xmath13 by using the time - shifted signal wavepacket @xmath14 , as also shown in table  [ table : modefunction ] . from the values below
, we can see that the contribution of the pre - leakage is very small .
the decay of the purity is thus due to the optical losses in each memory system .
these results are fitted with an exponential decay curve @xmath15 , where @xmath16 means the initial purity and @xmath17 means the memory lifetime for the memory system .          in the hom experiment , we synchronized the photon sources , created an initial dual - single - photon state , and then obtained an output hom state by replacing the highly - reflective rm in fig .
1a with a balanced beam splitter .
the storage time of each event was recorded together with the homodyne outcomes .
then , in order to observe the dependence on @xmath9 , we analyzed those events associated with a storage time between 0 and @xmath9
. figure  s1b shows the obtained number of events with respect to each @xmath9 .
it indicates a linear increase of the dual - heralding event rate for any extension of @xmath9 .
here we discuss how the maximum storage time @xmath9 is dependent on the dual - heralding event rate .
we assume that the individual heralding events of the memories occur at random and independently , i.e.  they follow the poisson distributions with average event rates @xmath18 for each memory-@xmath5 ( @xmath19 ) .
considering the ( dimensionless ) measurement duty @xmath20 and ignoring the 5-@xmath0s dead time for simplicity , the theoretical dual - heralding event rate is given by @xmath21 , when @xmath9 is much smaller than @xmath22 and @xmath23 . here
the factor of 2 effectively stems from the fact that the first heralding event may occur in either of memory-1 and memory-2 .
this linear relationship of the dual - heralding event rate for @xmath9 can be confirmed in fig .
the experimental parameters were @xmath24 counts per second ( cps ) , and @xmath25 .
from above , the predicted dual - heralding event rate for @xmath26 1.8  @xmath4 is @xmath27  cps , which agrees well with the experimental value of about 90  cps .
in order to estimate the enhancement by the memories in the dual - heralding event rate , here we discuss the coherence time of the wavepacket without synchronization , from the aspect of the 0.5-bound of the wigner - function - negativity condition .
however , we note that this is a problem dependent on how the signal wavepacket is defined .
a reasonable definition of the signal wavepacket is to set the temporal origin of the signal wavepaket to the mean of the two heralding event timings : when individual heralding events happen at @xmath28 and @xmath29 , then a signal wavepacket @xmath30 has a balanced overlap with both of @xmath31 and @xmath32 . by using this definition , we calculate the average purity for various timing - mismatched events @xmath33 as a function of the maximum time difference @xmath34 .
then we find that the average purity crosses the 0.5-bound of the wigner - function - negativity condition at @xmath34 = 72  ns .
comparing this @xmath34 of 72  ns with the @xmath9 of 1.8  @xmath4 for the synchronized case , and taking into account the linear dependence on @xmath9 , the memory enhancement in the event rate can be estimated at a factor of 25 .
let us now discuss the image of the hom state in the wave basis by considering wavefunctions ( probability amplitudes ) in fig .
s2 . theoretically , vacuum _ math _ , single - photon _ math _ , and two - photon _ math _ states have zero , one , and two nodes in their schrdinger standing wave functions _ math _ for the field quadrature amplitude _ math _ , respectively ( fig .
the two - mode wave functions of separable states _ math _ , _ math _ , and _ math _ are products of the single - mode wave functions ( figs .
s2b  d ) . when _ math _ and _ math _ are coherently superimposed to obtain the hom state , _ math _
, the probability amplitudes at the origin destructively or constructively interfere depending on _ math_. as a result , the superimposed wave function corresponds to a four - leaf clover for _ math _ ( fig .
s2e ) and a concentric pattern for _ math _ ( fig .
s2f ) . comparing fig .
s2e with fig .
s2d representing the input state _ math _ , we can see that the interference at the balanced beam splitter for _ math _ corresponds to a 45@xmath35 rotation of the pattern . the probability distributions _
math _ are the absolute squares of the wave functions ( figs .
s2g  h ) .
[ [ experimental - quadrature - distributions - for - the-36-measurement - bases ] ] experimental quadrature distributions for the 36 measurement bases ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    in the hom experiment , the optical phases @xmath36 of the two measured quadratures @xmath37 , @xmath38 are independently set to @xmath39 , @xmath40 , @xmath41 , @xmath42 , @xmath43 , and @xmath44 .
the quadrature distributions for the tested @xmath45 combinations are shown in fig .
these are the results for a @xmath9 of 400 ns as a typical example .
the distributions for equal relative phases , as can be seen in the plots along the diagonal of fig .
s3 , are almost the same , thus reflecting the phase - insensitivity of the input single - photon states .
the characteristic results of the output for the relative phase _ math _ of @xmath39 and _ math _ are collected in fig .
s4 , together with those of phase - insensitive input state .
[ [ quantitative - evaluation - of - the - entanglement - of - the - output - hom - state ] ] quantitative evaluation of the entanglement of the output hom state ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    here we quantitatively evaluate the output state with regards to its correlations , interference visibility , and entanglement .
the intensity cross - correlation factor , which corresponds to the depth of the hom dip , @xmath46 , is 0.24 @xmath47 0.01 .
the interference visibility , defined as @xmath48 is 0.902 @xmath47 0.005 .
this is much higher than the phase - randomized coherent light limit of 0.5 , which confirms the non - classicality of the output state . in order to verify the quantum entanglement in the two output ports
, we calculated the entanglement criterion @xcite .
the logarithmic negativity @xcite of the output state was @xmath49 , where the superscript of @xmath50 means partial transpose with respect to mode 1 . in order to exclude the contribution of undesired photon - number components to the entanglement
, we also calculated the logarithmic negativity of the output state after numerically applying local filters @xmath51 to individual modes .
the local filters do not increase the entanglement but just remove irrelevant photon - number components and transform the output state to @xmath52 . here
, @xmath53 is the filtered density operator of @xmath54 in the hilbert space spanned by @xmath55 , and @xmath56 , @xmath57 is the probability fraction of the filtered components which was experimentally 0.470 , and @xmath58 is a non - entangled state in the orthogonal hilbert space . for this filtered output state ,
the logarithmic negativity was @xmath59 .
from comparison of these two values , we can see the main contribution of the entanglement came from the superposition of @xmath60 and @xmath61 , but there is also a small discrepancy of the log - negativities which is mainly due to the higher - order photon components @xmath62 and @xmath63 of the input states .
the non - zero log - negativities of the filtered and unfiltered states confirm the entanglement of our output hom state .      by using the density matrices of the input states ( fig .
s5  a , b ) , we theoretically calculated a density matrix of the output state with the ideal balanced beam splitter ( fig .
s5  e , f ) .
compared to this simulation , the density matrix of the experimental output hom state has a similar structure ( fig .
s5  c , d ) .
additional important information about the phase - space characteristics of the entangled hom state can be obtained by analyzing its wigner function .
we calculated the wigner function of the output state in order to verify the strong non - classicality of this state .
the wigner function of a two - mode state @xmath64 is defined ( @xmath65 ) in four - dimensional space as @xmath66    where @xmath67 correspond to a pair of rotated quadratures . in fig .
s6 , the wigner function of the ideal hom state and that of the experimental output state are shown , for different vertical scales . as the wigner function is very sensitive to the non - classical properties of a quantum state , its value quickly changes owing to experimental imperfections .
however , the wigner function of the output state still shows the distinctive shape of the ideal hom state : it has a positive value at the origin and negative values at four points around the origin in fig .
s6c , which come from the strongly non - classical single - photon inputs , thus confirming that the output state maintains the strong non - classicality after the photon interference .